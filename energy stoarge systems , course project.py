import numpy as np
import matplotlib.pyplot as plt
import math
x=8001
m_0=.5
m_in=2.5e-4
m_out=2.0e-4
t=np.linspace(0,x-1,x)
m=np.zeros(x)
T_i=300
T_0=300
T_f=300
a_f=24e-3
print(a_f)
A_s=.175928
c_v=10.316
c_p=14.615
y=c_p/c_v
T=np.zeros(x)
m_hyd=2.0159e-3
v=.1508
R= 8.314

tou=np.zeros(x)
p=np.zeros(x)
H=np.zeros(x)
Q=np.zeros(x)
U=np.zeros(x)

T1=np.zeros(x)
p1=np.zeros(x)
H1=np.zeros(x)
Q1=np.zeros(x)
U1=np.zeros(x)

T2=np.zeros(x)
p2=np.zeros(x)
H2=np.zeros(x)
Q2=np.zeros(x)
U2=np.zeros(x)

A=[-35.17,-9.504,-10.51]
B=[36.16,10.50,11.50]
C=[.04595,.05526,.04841]
A1=[1.204,1.195,1.173]
C1=[1.631,1.000,1.026]
temp=[]
temp1=[]
y1=20
k=np.linspace(1,6,y1)

for i in range(0,x):
    if i<=2000:
        m[i]=m_0+m_in*i

        tou[i]=t[i]*m_in/m_0
        alpha = a_f * A_s / (c_v * m_in)
        T_star = (y * T_i + alpha * T_f) / (1 + alpha)
        T_star1=alpha*T_f/(1+alpha-y)
        T[i] = T_star - (T_star - T_0) / ((1 + tou[i]) ** (1+alpha ))
        p[i]=m[i]*R*T[i]/(m_hyd*v)
        H[i]=m_in*c_p*T_i
        Q[i]=a_f*A_s*(T_f-T[i])
        U[i]=H[i]+Q[i]
        #TC[i]=((A[j]+B[j]*(m[i]/m_0)**.5)**C[j])


        T1[i] = T_star1 - (T_star1 - T_0) / ((1 + tou[i]) ** (1 + alpha-y))
        p1[i] = m[i] * R * T1[i] / (m_hyd * v)
        H1[i] = m_in * c_p * T[i]
        Q1[i] = a_f * A_s * (T_f - T1[i])
        U1[i] = H1[i] + Q1[i]

        T2[i] = T_star - (T_star - T_0) / ((1 + tou[i]) ** (1 + alpha))
        p2[i] = m[i] * R * T2[i] / (m_hyd * v)
        H2[i] = m_in * c_p * T_i
        Q2[i] = a_f * A_s * (T_f - T2[i])
        U2[i] = H2[i] + Q2[i]



    elif i>2000 and i<=4000:
        m[i]=m[i-1]

        t_star=m[2000]*c_v/(a_f*A_s)
        tou[i] =t[i-2000]/t_star
        T_star = T_f
        T_star1=T_f
        T[i] = T_star - (T_star-T[2000])*math.exp(-tou[i])
        p[i] = m[i] * R * T[i] / (m_hyd * v)
        H[i]=0
        Q[i] = a_f * A_s * (T_f - T[i])
        U[i] = H[i] + Q[i]
        #TC[i] = ((A[j] + B[j] * (m[i] / m_0) ** .5) ** C[j])

        T1[i] = T_star1 - (T_star1 - T1[2000]) * math.exp(-tou[i])
        p1[i] = m[i] * R * T1[i] / (m_hyd * v)
        H1[i] = 0
        Q1[i] = a_f * A_s * (T_f - T1[i])
        U1[i] = H1[i] + Q1[i]

        T2[i] = T_star - (T_star - T2[2000]) * math.exp(-tou[i])
        p2[i] = m[i] * R * T2[i] / (m_hyd * v)
        H2[i] = 0
        Q2[i] = a_f * A_s * (T_f - T2[i])
        U2[i] = H2[i] + Q2[i]






    elif i>4000 and i<=6000:
        m[i]=1- m_out*(i-4000)

        tou[i] = -t[i-4000] * m_out / m[4000]
        alpha = -a_f * A_s / (c_v * m_out)
        T_star = (y * T_i + alpha * T_f) / (1 + alpha)
        T_star1 = alpha * T_f / (1 + alpha - y)
        T[i] = T_star - (T_star - T[4000]) / ((1 + tou[i]) ** (1 + alpha))
        p[i] = m[i] * R * T[i] / (m_hyd * v)
        H[i]=-m_out*c_p*T[i]
        Q[i] = a_f * A_s * (T_f - T[i])
        U[i] = H[i] + Q[i]
        #TC[i] = ((A[j] + B[j] * (m[i] / m_0) ** .5) ** C[j])

        T1[i] = T_star1 - (T_star1 - T1[4000]) / ((1 + tou[i]) ** (1 + alpha - y))
        p1[i] = m[i] * R * T1[i] / (m_hyd * v)
        H1[i] = -m_out * c_p * T[i]
        Q1[i] = a_f * A_s * (T_f - T1[i])
        U1[i] = H1[i] + Q1[i]

        T2[i] = T_star1 - (T_star1 - T2[4000]) / ((1 + tou[i]) ** (1 + alpha - y))
        p2[i] = m[i] * R * T2[i] / (m_hyd * v)
        H2[i] = -m_out * c_p * T[i]
        Q2[i] = a_f * A_s * (T_f - T2[i])
        U2[i] = H2[i] + Q2[i]





    else:
        m[i]=m[i-1]
        t_star = m[6000] * c_v / (a_f * A_s)
        tou[i] = t[i-6000] / t_star
        T_star = T_f
        T_star1=T_f
        T[i] = T_star - (T_star - T[6000]) * math.exp(-tou[i])
        p[i] = (m[i] * R * T[i] / (m_hyd * v))
        H[i]=0
        Q[i] = a_f * A_s * (T_f - T[i])
        U[i] = H[i] + Q[i]
        #TC[i] = ((A[j] + B[j] * (m[i] / m_0) ** .5) ** C[j])

        T1[i] = T_star1 - (T_star1 - T1[6000]) * math.exp(-tou[i])
        p1[i] = m[i] * R * T1[i] / (m_hyd * v)
        H1[i] = 0
        Q1[i] = a_f * A_s * (T_f - T1[i])
        U1[i] = H1[i] + Q1[i]

        T2[i] = T_star1 - (T_star1 - T2[6000]) * math.exp(-tou[i])
        p2[i] = m[i] * R * T2[i] / (m_hyd * v)
        H2[i] = 0
        Q2[i] = a_f * A_s * (T_f - T2[i])
        U2[i] = H2[i] + Q2[i]
for j in range(0,3):
    TC =np.zeros(y1)
    TC1=np.zeros(y1)
    for i in range(0,y1):
        TC[i]= ((A[j] + B[j] * (k[i] ) ** .5) ** C[j])
        TC1[i]= (A1[j]-(A1[j]-1)*k[i]**(-C1[j]))
    temp.append(TC)
    temp1.append(TC1)


plt.plot(k,temp[0],marker='D',markersize='4',color='blue',label='40s Data')
plt.plot(k,temp[1],marker='.',markersize='4',color='blue',label='190s Data')
plt.plot(k,temp[2],marker='>',markersize='4',color='blue',label='370s Data')
plt.plot(k,temp1[0],marker='.',markersize='4',color='orange',label='40s Data')
plt.plot(k,temp1[1],marker='x',markersize='4',color='orange',label='190s Data')
plt.plot(k,temp1[2],marker='v',markersize='4',color='orange',label='370s Data')
plt.xlabel('Final / initial mass m/m0')
plt.ylabel('Final/ initial temperature T/T0')
plt.grid()
plt.legend()
plt.show()


plt.plot(t,m)
plt.xlabel('Time(s)')
plt.ylabel('Mass(Kg)')
plt.title(' Variable inflow/outflow tempefrature ')
plt.grid()
plt.show()

plt.plot(t,T1)
plt.xlabel('Time(S)')
plt.ylabel('Temperature T(K)')
plt.title('Variable inflow/outflow temperature')
plt.grid()
plt.show()

plt.plot(t,p1)
plt.xlabel('Time(S)')
plt.ylabel('PRESSURE P(pa)')
plt.title('Variable inflow/outflow  temperature')
plt.grid()
plt.show()

plt.plot(t,H1)
plt.xlabel('Time(S)')
plt.ylabel('ENTHALPY H(KJ)')
plt.title('Variable inflow/outflow temperature')
plt.grid()
plt.show()

plt.plot(t,Q1)
plt.xlabel('Time(S)')
plt.ylabel('HEAT FLOW Q(KJ)')
plt.title('Variable inflow/outflow temperature')
plt.grid()
plt.show()

plt.plot(t,U1)
plt.xlabel('Time(S)')
plt.ylabel('Internal energy U(KJ)')
plt.title('Variable inflow/outflow temperature')
plt.grid()
plt.show()

plt.plot(t,m)
plt.xlabel('Time(S)')
plt.ylabel('Mass(Kg)')
plt.title('Constant inflow/outflow temperature')
plt.grid()
plt.show()

plt.plot(t,T)
plt.xlabel('Time(S)')
plt.ylabel('Temperature T(K)')
plt.title('Constant inflow/outflow temperature')
plt.grid()
plt.show()

plt.plot(t,p)
plt.xlabel('Time(S)')
plt.ylabel('PRESSURE P(pa)')
plt.title('Constant inflow/outflow temperature')
plt.grid()
plt.show()

plt.plot(t,H)
plt.xlabel('Time(S)')
plt.ylabel('ENTHALPY H(KJ)')
plt.title('Constant inflow/outflow temperature')
plt.grid()
plt.show()

plt.plot(t,Q)
plt.xlabel('Time(S)')
plt.ylabel('HEAT FLOW Q(KJ)')
plt.title('Constant inflow/outflow temperature')
plt.grid()
plt.show()

plt.plot(t,U)
plt.xlabel('Time(S)')
plt.ylabel('Internal energy U(KJ)')
plt.title('Constant inflow/outflow temperature')
plt.grid()
plt.show()

plt.plot(t,m)
plt.xlabel('Time(S)')
plt.ylabel('Mass(Kg)')
plt.title('Constant inflow and variable outflow temperature ')
plt.grid()
plt.show()

plt.plot(t,T2)
plt.xlabel('Time(S)')
plt.ylabel('Temperature T(K)')
plt.title('Constant inflow and variable outflow temperature')
plt.grid()
plt.show()

plt.plot(t,p2)
plt.xlabel('Time(S)')
plt.ylabel('PRESSURE P(pa)')
plt.title('Constant inflow and variable outflow temperature')
plt.grid()
plt.show()

plt.plot(t,H2)
plt.xlabel('Time(S)')
plt.ylabel('ENTHALPY H(KJ)')
plt.title('Constant inflow and variable outflow temperature')
plt.grid()
plt.show()

plt.plot(t,Q2)
plt.xlabel('Time(S)')
plt.ylabel('HEAT FLOW Q(KJ)')
plt.title('Constant inflow and variable outfow temperatures')
plt.grid()
plt.show()

plt.plot(t,U2)
plt.xlabel('Time(S)')
plt.ylabel('Internal energy U(KJ)')
plt.title('Constant inflow and variable outflow temperature')
plt.grid()
plt.show()


































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































9











































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































